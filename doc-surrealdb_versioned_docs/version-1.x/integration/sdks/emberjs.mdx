---
sidebar_position: 10
---

import ThemedImage from "@theme/ThemedImage";
import useBaseUrl from "@docusaurus/useBaseUrl";

# Ember.js

<ThemedImage
  alt="Ember.js"
  width="50"
  className="sdk-logo"
  sources={{
    light: useBaseUrl("img/light/emberjs.png"),
    dark: useBaseUrl("img/emberjs-icon.png"),
  }}
/>

# Ember.js SDK for SurrealDB

The SurrealDB SDK for Ember.js enables simple and advanced querying of a remote database from a browser. All connections to SurrealDB are made over WebSockets, and automatically reconnect when the connection is terminated. Under the hood, this SDK is powered by the SurrealDB Javascript SDK.

To contribute to this documentation, edit this file on GitHub.

To contribute to the SDK code, submit an Issue or Pull Request here.

:::note

<em>NOTE: </em>This SDK is compatible with V1.0.0

:::

<br />

### Install the SDK

First, install the SurrealDB SDK using npm:

```
npm install --save ember-surrealdb
```

Alternatively, you can use install the SurrealDB SDK using yarn, pnpm or similar:

```
yarn add ember-surrealdb
pnpm install ember-surrealdb
```

<br />

## Usage

After installation, services and decorators from the addon will be available for you to use in your apps.

### Config

The first step is to configure your database params in `app/config/environment.js`,

```javascript
const ENV = {
    ...
        surreal: {
        namespace: 'test',
        database: 'test',
        uri: 'http://127.0.0.1:8000',
        username: 'root',
        password: 'root',
        },
    ...
}
```

### Defining models

Models in the SurrealDB Ember.js adapter support a number of different field
types, embedded objects, embedded arrays, one-to-one foreign records,
many-to-many foreign records, and autosaving records.{" "}

#### Defining a model

In order to create a model, create a class which extends the default export
from `ember-surrealdb/model`. Use the field decorators to define the
fields on the model.

```javascript
// app/models/person.js
import Model from "ember-surrealdb/model";
import { any } from "ember-surrealdb/field";
import { boolean } from "ember-surrealdb/field";
import { datetime } from "ember-surrealdb/field";
import { number } from "ember-surrealdb/field";
import { string } from "ember-surrealdb/field";

export default class Person extends Model {
  @any custom; // Any field type
  @string name; // A string field
  @number age; // A number field
  @boolean admin; // A boolean field
  @datetime birthday; // A datetime field
}
```

#### Autosaving records

Instead of having to `save()` a record after modifying it, a model
can be specified to autosave whenever a change is made to it or any embedded
fields. Use the `@autosave` decorator to specify that a model class
should autosave.

```javascript
// app/models/account.js
import Model from "ember-surrealdb/field";
import { autosave } from "ember-surrealdb";

export default
@autosave
class Account extends Model {
  @string name;
}
```

#### Embedded arrays

For arrays of basic types, define the field on the base model using the{" "}

{" "}

`@array` decorator, and specify one of `string`, `number`, `boolean`, `datetime` as the first argument.
Omitting the first argument, will allow any type to be used in the array.

```javascript
// app/models/person.js
import Model from "ember-surrealdb/model";
import { array } from "ember-surrealdb/field";

export default class Person extends Model {
  @array() array; // An array of any value
  @array("string") tags; // An array of strings
  @array("number") numbers; // An array of numbers
  @array("boolean") booleans; // An array of booleans
  @array("datetime") datetimes; // An array of datetimes
}
```

#### Embedded objects

For objects, define the field on the base model using the `@object`{" "}
decorator, specifying the dasherized model name as the first argument. Next,
define the embedded field as a separate model which extends the default export
from `ember-surrealdb/field`.

```javascript
// app/models/person.js
import Model from "ember-surrealdb/model";
import { object } from "ember-surrealdb/field";

export default class Person extends Model {
  @object("person-name") name;
}
```

```javascript
// app/models/person-name.js
import Field from "ember-surrealdb/field";
import { string } from "ember-surrealdb/field";

export default class PersonName extends Field {
  @string firstname;
  @string lastname;
}
```

#### Embedded arrays of objects

For arrays of embedded objects, define the field on the base model using the{" "}

{" "}

`@array` decorator, and specify the dasherized model name as the first
argument. Next, define the embedded field as a separate model which extends the default
export from `ember-surrealdb/field`.

```javascript
// app/models/person.js
import Model from "ember-surrealdb/model";
import { array } from "ember-surrealdb/field";

export default class Person extends Model {
  @array("person-skills") skillsets; // An array of embedded objects
}
```

```javascript
// app/models/person-skills.js
import Field from "ember-surrealdb/field";
import { string } from "ember-surrealdb/field";
import { number } from "ember-surrealdb/field";

export default class PersonSkills extends Field {
  @string name;
  @number years;
}
```

### Foreign relationships

#### One-to-one relationships

To declare a one-to-one relationship between two models, use the{" "}

{" "}

`@record` decorator on each of the models. Specify the dasherized model
name as the first argument to the decorator.

```javascript
// app/models/user.js
import Model from "ember-surrealdb/model";
import { record } from "ember-surrealdb/field";

export default class User extends Model {
  @record("profile") profile; // A pointer to another record
}
```

```javascript
// app/models/profile.js
import Model from "ember-surrealdb/model";
import { record } from "ember-surrealdb/field";

export default class Profile extends Model {
  @record("user") user; // A pointer to another record
}
```

#### One-to-many relationships

To declare a one-to-many relationship between two models, use the{" "}

{" "}

`@array` and `@record` decorators. Specify the dasherized model
name as the first argument to the decorator.

```javascript
// app/models/post.js
import Model from "ember-surrealdb/model";
import { array } from "ember-surrealdb/field";

export default class Post extends Model {
  @array("comments") comments; // An array of record pointers
}
```

```javascript
// app/models/comment.js
import Model from "ember-surrealdb/model";
import { record } from "ember-surrealdb/field";

export default class Comment extends Model {
  @record("post") post; // A pointer to another record
}
```

#### Many-to-many relationships

To declare a many-to-many relationship between two models, use the{" "}

{" "}

`@array` decorator on each model. Specify the dasherized model name as
the first argument to the decorator.

```javascript
// app/models/post.js
import Model from "ember-surrealdb/model";
import { array } from "ember-surrealdb/field";

export default class Post extends Model {
  @array("tag") tags; // An array of record pointers
}
```

```javascript
// app/models/tag.js
import Model from "ember-surrealdb/model";
import { array } from "ember-surrealdb/field";

export default class Tag extends Model {
  @array("post") posts; // An array of record pointers
}
```

### Services

The addon comes with 3 services.

- Session
- Store
- Surreal

#### Session service

The session service has a number of convinient

#### Store service

The store service provides convinient methods that allow you to query your database and get results in format similar to ember-data.

`select()` queries the database for a particular type eg the `person` model.

```javascript
this.store.select("person");
```

`select()` can also be used to get a particular model based on it's id

```javascript
this.store.select("person:123456789");
```

`create()` is used to create entries of a particular model in the database

```javascript
this.store.create("person", { name: "John Doe" });
```

`modify` is used to update a record using it's `id` and object of fields to change.

```javascript
this.store.modify("person", { name: "Changed" });
```

`update()` is used to update a record based on changes done to the model.

```javascript
this.store.update("person", personModel);
```

`delete()` deletes a model from the database and removes it from the store.

```javascript
this.store.delete("person:123456789");
```

#### Surreal service

This service it just a one to one re-export of the `surrealdb.js` package methods. It exposes the properties below

##### Connection opened?

```hbs
{{this.surreal.opened}}
```

##### Authentication attempted?

```hbs
{{this.surreal.attempted}}
```

##### Current authentication status?

```hbs
{{this.surreal.invalidated}}
```

```hbs
{{this.surreal.authenticated}}
```

### Decorators

The addon comes with a couple of decorators which are convenient for easy app development.

#### @attempted

In order to prevent a route from progressing until the WebSocket connection with the database has attempted authentication (regardless of whether it fails or succeeds), apply the @attempted decorator to a route. This decorator would normally be applied to the application route, to prevent the application from progressing until a database connection has been successful, and authentication has been attempted.

```javascript
import Route from "@ember/routing/route";
import { attempted } from "ember-surrealdb";

export default
@attempted
class extends Route {
  // This route will wait for the SurrealDB
  // connection to attempt authentication
  // before progressing.
}
```

#### @authenticated

In order to only display a route if the user is authenticated, add the @authenticated decorator to a route, and specify the redirectIfInvalidated property within the route. If the user navigates to the route but is not yet authenticed, they will be redirected to the specified route.

```javascript
import Route from "@ember/routing/route";
import { authenticated } from "ember-surrealdb";

export default
@authenticated
class extends Route {
  // The user will be redirected to the
  // 'signin' route if they have not yet
  // authenticated with the database.
  redirectIfInvalidated = "signin";
}
```

#### @autosave

Instead of having to save() a record after modifying it, a model can be specified to autosave whenever a change is made to it or any embedded fields. Use the @autosave decorator to specify that a model class should autosave.

```javascript
// app/models/account.js
import Model from "ember-surrealdb/field";
import { autosave } from "ember-surrealdb";

export default
@autosave
class Account extends Model {
  @string name;
}
```

#### @invalidated

In order to only display a route if the user is unauthenticated, add the @invalidated decorator to a route, and specify the redirectIfAuthenticated property within the route. If the user navigates to the route but is already authenticed, they will be redirected to the specified route.

```javascript
import Route from "@ember/routing/route";
import { invalidated } from "ember-surrealdb";

export default
@invalidated
class extends Route {
  // The user will be redirected to the
  // 'index' route if they have already
  // authenticated with the database.
  redirectIfAuthenticated = "index";
}
```

#### @signout

In order to properly invalidate a user's session, and to remove all locally cached data in the store, add the @signout decorator to a route, and navigate the user to this route to signout. When the user navigates to this route, the store will be reset, the session cleared, and all locally cached records will be removed. Finally the user will be redirected to the route specified with the redirectAfterSignout property.

```javascript
import Route from "@ember/routing/route";
import { signout } from "ember-surrealdb";

export default
@signout
class extends Route {
  // When the user navigates to this
  // route, they will be redirected to
  // the signing route, the store will
  // be reset, and the session cleared.
  redirectAfterSignout = "signin";
}
```
